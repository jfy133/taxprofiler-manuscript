{"title":"nf-core/taxprofiler: highly parallelised and flexible pipeline for metagenomic taxonomic classification and profiling","markdown":{"yaml":{"title":"nf-core/taxprofiler: highly parallelised and flexible pipeline for metagenomic taxonomic classification and profiling","author":[{"name":"Sofia Stamouli","given":"Sofia","family":"Stamouli","orcid":"0009-0006-0893-3771","roles":["conceptualization","software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"Moritz E. Beber","given":"Moritz","family":"Beber","orcid":"0000-0003-2406-1978","roles":["conceptualization","software","editing"],"affiliations":[{"ref":"usb"}]},{"name":"Tanja Normark","given":"Tanja","family":"Normark","orcid":null,"roles":["software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"Thomas A. Christensen II","given":"Thomas A.","family":"Christensen II","orcid":"0000-0003-1219-9320","roles":["software","editing"],"affiliations":[{"ref":"ksu"}]},{"name":"Lili Andersson-Li","given":"Lili","family":"Andersson-Li","orcid":"0000-0002-6059-4192","roles":["software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"Maxime Borry","given":"Maxime","family":"Borry","orcid":"0000-0001-9140-7559","roles":["software","editing"],"affiliations":[{"ref":"eva"}]},{"name":"Mahwash Jamy","given":"Mahwash","family":"Jamy","orcid":null,"roles":["software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"nf-core community","url":"https://nf-co.re","email":"core@nf-co.re","roles":["software"],"affiliations":[{"ref":"xx"}]},{"name":"James A. Fellows Yates","given":"James A.","family":"Fellows Yates","orcid":"0000-0001-5585-6277","email":"james_fellows_yates@eva.mpg.de","corresponding":true,"roles":["conceptualization","project administration","software","supervision","writing","editing"],"affiliations":[{"ref":"eva"},{"ref":"hki"}]}],"affiliations":[{"id":"ki","name":"Department of Microbiology, Tumor and Cell Biology, Karolinkska Institutet","address":"Solnavägen 1","city":"Solna","state":"Stockholm","postal-code":17177,"country":"Sweden"},{"id":"kuh","name":"Department of Clinical Microbiology, Karolinska University Hospital","address":"Anna Steckséns gata 41","city":"Solna","state":"Stockholm","postal-code":17177,"country":"Sweden"},{"id":"usb","name":"Unseen Bio ApS","address":"Fruebjergvej 3","city":"Copenhagen","state":"Capital Region","postal-code":2100,"country":"Denmark"},{"id":"eva","name":"Department of Archaeogenetics, Max Planck Institute for Evolutionary Anthropology","address":"Deutsche Pl. 6","city":"Leipzig","state":"Saxony","postal-code":2115,"country":"Germany"},{"id":"hki","name":"Department of Paleobiotechnology, Leibniz Institute for Natural Product Research and Infection Biology Hans Knöll Institute","address":"Adolf-Reichwein-Straße","city":"Jena","state":"Thuringen","postal-code":4069,"country":"Germany"},{"id":"ksu","name":"Veterinary Diagnostic Laboratory, Kansas State University College of Veterinary Medicine","address":"1800 Denison Ave","city":"Manhattan","state":"KS","postal-code":66506,"country":"United States"},{"id":"xx"}],"bibliography":"refs.bib","license":"CC BY","crossref":{"lst-prefix":"Code Block"},"number-sections":true},"headingText":"Abstract","containsRefs":false,"markdown":"\n\n\nMetagenomic classification tackles the problem of characterising the taxonomic source of all DNA sequencing reads in a sample.\nA common approach to address the differences and biases between the many different taxonomic classification tools is to run metagenomic data through multiple classification tools and databases.\nThis, however, is a very time-consuming task when performed manually - particularly when combined with the appropriate preprocessing of sequencing reads before the classification.\n\nHere we present nf-core/taxprofiler, a highly parallelised taxonomic classification and processing pipeline that allows for automated and simultaneous classification and/or profiling of both short- and long-read metagenomic sequencing libraries against a large number of taxonomic classifiers and profilers as well as databases within a single pipeline run.\nImplemented in Nextflow and as part of the nf-core initiative, the pipeline benefits from high levels of scalability and portability, allowing for large and small projects on a wide range of computing infrastructure, as well as best-practise software development and community support to ensure longevity and adaptability of the pipeline, keeping up with the field of metagenomics.\n\n## Introduction\n\nShotgun metagenomics offers strong benefits to the taxonomic classification of DNA samples over targeted approaches [@Eloe-Fadrosh2016-gz;@Breitwieser2019-ys].\nWhile metabarcoding approaches targeting the 16S rRNA or other marker genes are widely due to low cost and large, diverse reference databases [@Yilmaz2014-js;@Lynch2015-mz], metagenomic approaches have been gaining popularity with the increasingly lower costs of shotgun sequencing.\nThese metagenomic analyses have been shown to provide similar resolution on microbial genomes during taxonomic classification [@Hillmann2018-ud], with the added benefit of having greater reusability potential of the data, via whole genome reconstruction and also functional classification of metagenomics [@Sharpton2014-wy;@Quince2017-bl].\n\nTaxonomic classifiers (sometimes referred to as taxonomic binners) consists of identifying the original 'taxonomic source' of a given DNA sequence [@Ye2019-fl;@Meyer2022-dg;@Govender2022-td].\nIn metagenomics, this typically consists of comparing millions of DNA sequences against hundreds or thousands of reference genomes either via alignment or 'k-mer matching' [@Sharpton2014-wy;@Sun2021-tq], with the most close match being considered the most likely original 'source' organism of that sequence.\nTaxonomic profilers additionally will also try to infer species abundance of the organism in the original sample, based on the sequence abundance [@Nayfach2016-ej].\nWe will use classifiers and profilers interchangeably throughout the publication.\n\nDue to the scale of the problem, taxonomic profiling remains an 'unresolved problem' in bioinformatics.\nHaving to identify the original source of many sequences out of many reference genomes, but in an _efficient_ manner, is understandably a difficult problem.\nTherefore a plethora of tools have been developed to address this challenge, all with their own biases and specific contexts [@Sczyrba2017-ma;@Meyer2022-dg].\nAdditionally, each tool often produces tool-specific output formats making it difficult to efficiently cross compare results.\nThus, no established 'gold standard' method currently exists.\n\nOne solution to address the range of different tools is to run all of them in parallel, and cross compare the results.\nThis can be useful both for benchmarking studies [e.g. @Sczyrba2017-ma;@Meyer2022-dg], but also to build consensus profiles whereby confidence of a particular taxonomic identification can be increased when it is detected by multiple tools [@McIntyre2017-td;@Ye2019-fl].\n\nA second challenge in taxonomic classification is a question of databases. As with tools, there is no one set 'gold standard' database.\nDifferent questions and contexts may require different databases, such as when a researcher wants to search for both bacterial and virus species in samples, and as an extension of this, taxonomic classifiers may need different settings for each database.\nFurthermore, as genomic sequencing becomes cheaper and more efficient, the number of publicly available reference genomes are rapidly increasing [@Nasko2018-cl], making the size of databases taxonomic classifiers also much larger and often outpacing the computational capacity available to researchers.\nIn fact, while this was one of the main motivations behind classifiers such as Kraken2 [@Wood2019-mf], these algorithmic techniques are already becoming insufficient [@Wright2023-yr].\n\nFinally, with the decrease of costs, the possibility for larger and larger metagenome sequencing datasets increases, leading to increasing sample sizes in studies, as exemplified by the doubling of the number of metagenomes on the European Bioinformatic Institute's MGnify database in two years [@Mitchell2019-kt].\nAltogether this highlights the need for methods to efficiently profile many samples using many tools.\nManually setting up bioinformatic jobs for classification tasks for each database and settings against different tools on traditional academic computing infrastructure (e.g. high performance computing clusters or 'HPC' clusters) can be very tedious.\nAdditionally, particularly for very large sample sets, there is increasing use of cloud platforms that have greater scalability than traditional HPCs.\nBeing able to reliably and reproducibly execute taxonomic classification tasks across infrastructure with minimal intervention would therefore be a boon for the metagenomics field.\n\nHere we present nf-core/taxprofiler, a pipeline designed to allow users to efficiently and simultaneously taxonomically classify and profile short- and long-read sequencing data against multiple tools and databases in a single pipeline run.\nnf-core/taxprofiler utilises Nextflow [@Di_Tommaso2017-xu] to ensure efficiency, portability, and scalability, and has been developed within the nf-core initiative of Nextflow pipelines [@Ewels2020-vi] to ensure high quality coding practises and user accessibility, including detailed documentation and a graphical-user-interface (GUI) execution interface.\n\n## Implementation\n\nnf-core/taxprofiler aims to facilitate three main steps of a typical shotgun metagenomic workflow [@Chiu2019-mv].\nTaking in short- (e.g. Illumina) or long-read (e.g. Nanopore) FASTQ or FASTA files, it can (1) perform a range of appropriate read preprocessing steps, (2) perform taxonomic classification and profiling against a range of different tools depending on user preferences, and finally (3) perform post-classification aggregation and standardisation of the resulting profiles with the possibility of visualisation to the outputs (@fig-workflow-diagram).\nAll relevant preprocessing statistics are displayed in an interactive and dynamic MultiQC report [@Ewels2020-vi].\n\n![Visual overview of the nf-core/taxprofiler workflow. nf-core/taxprofiler can take in FASTQ (short or long reads) or FASTA files (long reads), that will optionally go through sequencing quality control (e.g. with FastQC), read preprocessing (e.g. removal of adapters), complexity filtering, host removal, and run merging before performing taxonomic classification and/or profiling with a user-selected range of tools and databases. Output from all classifiers and profilers are standardised into a common taxon table format, and when supported visualisations of the profiles are generated.](taxprofiler_tube.png){#fig-workflow-diagram fig-alt=\"Visual overview of the nf-core/taxprofiler workflow. nf-core/taxprofiler can take in FASTQ (short or long reads) or FASTA files (long reads), that will optionally go through sequencing quality control, read preprocessing, complexity filtering, host removal, and run merging before going into taxonomic classification and/or profiling with a user-selected range of tools and databases. Output from all classifiers and profilers are additionally standardised into a common taxon table format and some with visualisation of profiles.\"}\n\n### Input and Execution\n\nThe pipeline can be executed via typical Nextflow commands, or using the standard nf-core 'launch' graphical-user-interface (GUI) ([https://nf-co.re/taxprofiler/launch](https://nf-co.re/taxprofiler/launch)), making the pipeline accessible for both computationally experienced as well as less experienced researchers.\nIn addition to the general usage and parameter documentation of the pipeline (https://nf-co.re/taxprofiler).\nThe GUI offers immediate assistance and guidance to users on what each parameter does, both in short- and long-form, with long-form parameter descriptions additionally describing which tool-specific parameter(s) are being modified for each pipeline parameter ([@fig-launch-page]).\nThe GUI also includes controlled user input by providing strict drop-down lists and input validation prior execution of the pipeline to reduce the risk of typos and other mistakes (in contrast to the command-line interface (CLI) that only includes validation at pipeline run-time).\n\n![Screenshot of the nf-core pipeline launch graphical user interface with nf-core/taxprofiler options displayed. The web browser-based interface provides guidance for how to configure each pipeline parameter by providing both short and long help descriptions to help guide users in which contexts to configure each parameter. Additional elements such as radio buttons, drop down menus, and background regular expressions check for validity of input. When pressing launch, a prepared configuration file and command is provided that can be copied and pasted by the user into the terminal](taxprofiler_launchpage.png){#fig-launch-page fig-alt=\"Screenshot of the nf-core pipeline launch graphical user interface with nf-core/taxprofiler options displayed. The web browser-based interface provides guidance for how to configure each pipeline parameter by providing both short and long help descriptions to help guide users in which contexts to configure each parameter. Additional elements such as radio buttons, drop down menus, and background regular expressions check for validity of input. When pressing launch, a prepared configuration file and command is provided that can be copied and pasted by the user into the terminal\"}\n\nAn example nf-core command line execution of the pipeline can be seen in figure (@lst-example-cmd), where two input files are supplied: one file specifying paths of FASTQ files of metagenomic samples and necessary metadata for preprocessing (such as sample ID and sequencing platform), and the second file specifying paths to the user-defined databases with per-database classification parameters.\nVarious parameters are available to optionally turn on different preprocessing steps, and provide additional configurations such as tool selection and value options.\nNote that even if a user supplies a given database in the database input sheet, the corresponding profiling tool must still be activated with the corresponding pipeline parameter (e.g. `--run_kraken2`).\nPer-classifier flags are also available for the optional saving of additional non-profile output files.\n\n```{#lst-example-cmd .bash lst-cap=\"Example nf-core/taxprofiler command for running short-read quality control, removal of host DNA and executing the k-mer based Kraken2 and marker gene alignment MetaPhlAn3 tools.\"}\n$ nextflow run nf-core/taxprofiler -r 1.1.0 \\\n-profile singularity,<institute> \\\n--input <samplesheet.csv> --databases <database.csv> \\\n--perform_shortread_qc  --shortread_qc_minlength 20 --preprocessing_qc_tool falco \\\n--run_host_removal --hostremoval_reference 'host_genome.fasta' \\\n--run_kraken2 --kraken2_save_reads \\\n--run_metaphlan3 \\\n--run_krona \\\n--run_profile_standardisation \\\n```\n\nAll nf-core pipelines are strictly versioned (specified with the Nextflow `-r` flag), and to ensure reproducibility, each version of the pipeline has a fixed set of software used for each step of the pipeline.\nThe fixed set of software are controlled through the use of the conda package manager and containers (e.g., Docker, Apptainer [previously known as Singularity]) from the stable Bioconda [@Gruning2018-vr] and BioContainers [@Da_Veiga_Leprevost2017-gl] repositories.\nThis, coupled with the intrinsic Nextflow ability to execute on most infrastructure whether that is a local laptop (resource requirements permitting), traditional HPC, as well across common cloud providers also makes nf-core/taxprofiler a very portable pipeline that can be used across many contexts.\n\n### Preprocessing\n\nPreprocessing steps in nf-core/taxprofiler are aimed at removing laboratory and sequencing artefacts that may influence taxonomically profiling, either for computing resource consumption and/or false-positive or false-negative classification reasons.\nFirst sequencing quality control with FastQC [@Andrews2010-pd] or Falco [@De_Sena_Brandine2021-pi] is carried out.\nFalco was included in for reduced memory requirements, in particular for long reads sequencing.\nArtificial library adapter sequences added during sequencing reduces accuracy during alignment by reducing sequence specificity, and in some cases, may result in false-positive hits due to adapter sequence contamination in reference genomes [@Schaffer2018-be;@Breitwieser2018-xg] [^1].\nAdditionally, the paired-end merging may provide longer sequences that will allow more specific classification when paired-end alignment is not supported by a given classifier.\nFor these tasks nf-core/taxprofiler can apply either fastp [@Chen2018-vg] or AdapterRemoval2 [@Schubert2016-qv] for short-reads, and currently Porechop [@Wick2017-cn] for Oxford Nanopore long-read data.\nFor both short- and long-reads FastQC or Falco is run again to allow assessment on the performance of the adapter removal and/or pair-merging step.\n\nLow complexity sequences, e.g. sequences containing long stretches mono- or di-nucleotide repeats provide little specific genetic information that contribute to taxonomic identification, as they can align to many different reference genomes [@Schmieder2011-ea;@Clarke2019-al].\nIncluding such reads during taxonomic profiling can increase run-time and memory usage for little gain, as during lowest-common-ancestor (LCA) classification steps they will be assigned to high-level taxonomic levels (e.g. Kingdom).\nnf-core/taxprofiler performs removal of these reads through complexity filtering algorithms as provided by fastp, BBDuk [@Bushnell2022-pf], or PRINSEQ++ [@Cantu2019-lh].\nLong read sequences often do not have such reads as lengths are sufficient enough to capture greater sequence diversity - but it is sometimes desired to only classify reads longer than a certain length - as these provide more precise taxonomic information [@Dilthey2019-ps;@Portik2022-jp].\nTherefore, nf-core/taxprofiler can remove reads shorter than a user-defined length using Filtlong.\n\nRemoving host DNA is another common preprocessing step in metagenomic studies.\nThis can help speed up run-time, particularly in microbiome studies, where detection of microbes are of interest.\nFurthermore, host-contamination of reference genomes in public databases is common [@Longo2011-qd;@Kryukov2016-my;@Breitwieser2019-iz] and therefore the removal of such sequences can also decrease the risk of false positive taxonomic assignment.\nTo remove multiple hosts or other sequences, all reference genomes can be combined into a single FASTA reference file.\nShort-read host removal can be carried out with Bowtie2 [@Langmead2012-ik;@Langmead2019-ej] and minimap2 [@Li2018-qq] for long-reads, both in combination with SAMtools [@Li2009-wy;@Danecek2021-gj], where reads are aligned against the reference genome and the off-target (unaligned) reads are then converted back to FASTQ format for classification.\n\nFinally, nf-core/taxprofiler can optionally perform run merging where libraries have been sequenced over multiple lanes to generate one profile per sample or library.\nThe final set of reads used for profiling can be optionally saved for downstream re-use.\n\nThroughout all steps, relevant statistics and log files are generated and used both for the final pipeline run report as well as saved into the results directory of the pipeline run for further inspection where necessary.\n\n### Profiling\n\nThere are many types of metagenomic profiling techniques, from profiling against whole-genome references with alignment or k-mer based approaches, to methods involving alignment to species-specific marker-gene families [@Quince2017-bl,@Ye2019-fl].\nnf-core/taxprofiler aims to support and include all established classification or profiling tools as requested by the community.\nThe choice of tools used in a pipeline run is up to the user, with a tool being executed when both the corresponding database and `--run_<tool>` flag is provided.\nSpecific classification settings for each tool and database are specified in the database CSV input sheet.\nSome tools also have pipeline level command-line flags for controlling certain aspects of output files.\n\nAs of version 1.1.0, the following classifiers and profilers are available: Kraken2 [@Wood2019-mf], Bracken [@Lu2017-vc], KrakenUniq [@Breitwieser2018-xg], Centrifuge [@Kim2016-qc], MALT [@Vagene2018-px], DIAMOND [@Buchfink2021-ks], Kaiju [@Menzel2016-xy], MetaPhlAn [@Blanco-Miguez2023-cq], mOTUs [@Ruscheweyh2022-hn], ganon [@Piro2020-es], KMCP [@Shen2023-bk]. [@tbl-tool-summaries] in Supplementary Data summarises the category and reference database type for each tool.\n\nBy default, nf-core/taxprofiler produces the per-sample main taxonomic classification profile from a tool or a tool's report generation tool.\nThe output is normally in the form of counts per reference sequencing, with additional statistics about the hits of a particular organism (estimated abundance, taxonomic level etc.).\nUsers can also optionally request output of per-read classification output, and output such as classified and unclassified reads in FASTQ format, where supported.\n\nThe pipeline provides high efficiency, particularly during the metagenomic classification stage, through the inherent parallelisation provided by Nextflow.\nWhile metagenomic classification is comparatively computationally intensive (in terms of memory and execution time; due to a combination of sequencing depth and number of reference genomes), Nextflow automatically optimises the execution order of all the steps in pipeline, maximising the number parallel running of multiple profilers and/or databases at any given time point, as far as the available computational resources allow.\nFor local machines such as laptops or desktops, Nextflow will automatically detect all available computational sources but this is customisable using custom Nextflow configuration files.\nFor HPC and cloud infrastructure, users typically have to define the computational infrastructural environment the pipeline is being executed on (CPU or memory limitations, queues, instance types etc.).\nTo facilitate the pipeline set-up, nf-core/taxprofiler supports pre-defined centralised generic and pipeline-specific institutional Nextflow configurations as provided by nf-core/configs ([https://nf-co.re/configs](https://nf-co.re/configs); more than 90 institutions at the time of writing).\nHowever, users are still welcome to supply their own custom configuration files, further refining computational limitations or execution specifications.\n\n### Post-profiling\n\nIn metagenomic studies, it is common practise to compare the profiles among many samples, and the results of multiple profiles are normally stored in 'taxon tables', i.e, counts per reference (rows), for each sample (columns).\nWhen available, nf-core/taxprofiler supports the option to produce the 'native' taxon table of each classification tool when multiple samples are run.\n\nOne of the challenges that researchers face when comparing multiple taxonomic classifiers or profilers is the heterogenous output formats that are produced, and often requires custom parser and merging scripts for each tool to standardise.\nTo facilitate more user-friendly cross-comparison between tools, nf-core/taxprofiler utilises the TAXPASTA tool [@Beber2023-hk] to generate standardised profiles and generate multi-sample tables.\n\nSummary statistics for the entire pipeline are visualised and displayed in a customisable MultiQC report [@Ewels2020-vi], when supported, to support user quality control of data and pipeline runs.\nKrona plots [@Ondov2011-se] can also optionally be generated for supported tools to help provide further visualisation of taxonomic profiles.\n\n### Output\n\nTo summarise, the main default output from nf-core/taxprofiler are both classifier 'native' and standardised single- and multi-sample taxonomic profiles with counts per-taxon and an interactive MultiQC run report with all run statistics, in addition to the raw log files themselves where available.\n\nThe MultiQC run report displays statistics and summary visualisations for all steps of the pipeline where possible, lists of versions for all tools of each step of the pipeline, and provides a dynamically-constructed text for the recommendeded 'methods' text for reporting how the pipeline was executed (including relevant citations) that users can use in their own publications.\n\nOptional outputs can include other types of profiles (e.g. per read classification) and in other formats as produced by the tools themselves, as well as raw reads from preprocessing steps and output visualisations from Krona.\nNextflow resource usage and trace reports are also by default produced for users to check pipeline performance.\n\n<!--\n\nTODO: Version 2 of preprint\n\n## Use Cases and Benchmarking\n\nTo demonstrate different uses of nf-core/taxprofiler, we ran the pipeline on datasets of XXXX  from XXX , on a XXXX .\n\nRun metric can be seen in Figure XXXXXX .\n\n-->\n\n## Discussion\n\n### Comparison with other solutions\n\nnf-core/taxprofiler has been specifically developed for the analysis of _metagenomic_ data.\nWhile other types of taxonomic profiling data such as 16S amplicon sequencing are well established fields with a range of popular high-quality and best-practise tools pipelines (e.g. [@Blanco-Miguez2023-cq;@Schloss2009-vk]) and databases [@DeSantis2006-cm;@Yilmaz2014-js], whereas 'gold standard' tools and databases for metagenomics remains are much less established - thus the need for highly-multiplexed classification is more desirable for the newer metagenomics methods.\nDespite this, tools such as METAXA2 [@Bengtsson-Palme2015-ar] that use shotgun sequencing reads to recover 16S sequences from metagenomic samples.\n\nA range of pipelines already exist for taxonomic profiling, however each have their own particular purpose and abilities.\nHere we compare the functionality of nf-core/taxprofiler against four other recently published or released pipelines, selected based on their similarity of purpose to nf-core/taxprofiler.\nWe searched Google Scholar for open-source pipelines published or released in the last 5 years (at the time of writing, since 2018) that were designed primarily for metagenomic classification screening, that supported at least 2 classifiers, had at laest one preprocessing step and was not specificaly targeted at read classification of specific domains of taxa (e.g. virus or bacteriophage only).\nWe also included an additional pipeline at the recommendations of the authors of the pipeline due to the functional overlap to nf-core/taxprofiler. We then evaluted the pipelines based on their publications and documentation for typical metagenomic profiling workflow steps, and a range criteria related to expectations of modern bioinformatic workflows that can be summarised in the following four criteria: reproducibility, accessibility, scalability, and portability [@Wratten2021-es]. After searching, we selected the following pipelines for comparison with nf-core/taxprofiler: sunbeam [v4; @Clarke2019-al], Unipro UGENE [v48; @Rose2019-jf], TAMA [githash: 3a22c8f; @Sim2020-ja], and StaG-mwc [0.7.0; @Boulund2023-ct].\n\nIn terms of accessibility, all pipelines have documentation describing the installation steps, usage instructions, and output files.\nHowever, there are varying levels of detail and comprehensiveness. In particular, StaG-mwc and nf-core/taxprofiler have the most detailed descriptions of all possible output files for every supported module, whereas Unipro UGENE and sunbeam have very minimal to possibly unfinished output documentation.\nFor execution options, most of the pipelines provide CLI execution, except for Unipro UGENE offers only GUI-based pipeline set-up (despite a command-line execution of the GUI generated configuration). In particular, nf-core/taxprofiler is the only pipeline providing both CLI and GUI interfaces for pipeline run execution.\n\nCriteria covering portability also overlaps with accessibility, as it implies the options and ease that different users can run on different types of computing infrastructure, whether that is on their own laptop, on a HPC cluster or in the cloud.\nUnipro UGENE is the only pipeline that supports execution on all three major operating systems (Linux, OSX, Windows), whereas StaG-mwc and nf-core/taxprofiler can be run on unix operating systems, and sunbeam and TAMA are only being supported on Linux.\nWhile all pipelines support 'local' machine execution (e.g. personal laptops or desktops), a large portion of academic users execute computationally intensive bioinformatic tasks on HPC clusters.\nIn these contexts, pipeline task submissions are normally managed by job schedulers, thus integration with schedulers is an important criteria for running large multi-step and parallelised pipelines.\nThe three pipelines leveraging workflow managers (Snakemake [@Molder2021-et] and Nextflow) support integration with schedulers (StaG-mwc, sunbeam, and nf-core/taxprofiler) with nf-core/taxprofiler supporting the most by far ([>10 scheduling systems](https://www.nextflow.io/docs/latest/executor.html)) as natively offered by Nextflow. This allows the greatest possible choice or users in terms of which HPC infrastructure they could execute their pipeline on.\nAs an extension of this, only nf-core/taxprofiler has explicitly described support for cloud computing (e.g. AWS or Microsoft Azure), again maximising user choice and accessibility when it comes to running the pipeline.\n\nIn terms of scalability, the aforementioned integration with schedulers and cloud computing support implicit maximises efficiency and parallellisation of pipeline runs, providing good scalability for varying numbers of input files and steps in the pipeline. Again, the three workflow manager based pipelines provide scalability, whereas there is no mention neither Unipro UGENE nor TAMA in reference to parallel task execution. Furthemore, all pipelines except TAMA, allowed per-process customisation of computational resources, something critical for maximising efficient scalability to ensure only the necessary resources for a given step of a pipeline are requested.\n\nIn terms of reproducibility, all five pipelines are good at ensuring reproducibility in terms of pipeline and software versioning (allowing re-execution of pipeline runs using the same software), with only tama not having stable versioned releases.\nHowever, installing software manually across different infrastructures can result in variability in the execution of each software [^2] [@Di_Tommaso2017-xu].The current most popular solution to the problem of inconsistent software environments is to use container engines such as Docker or Apptainer. These allow 'snapshotting' of a operating system and all configuration and fixed versions of all software required for the pipeline.\nOnly Unipro UGENE does not document the use of a container system with nf-core/taxprofiler offering the biggest choice for users courtsey of Nextflow (6 different engine systems at the time of writing).\n\nFinally we compared metagenomics related functionality between the pipelines. All pipelines support short-read FASTQ input, but only nf-core/taxprofiler explicitly reports long-read support, while the documentation in Unipro UGENE states that assembled contigs are possible input to some of the profilers.\nAll pipelines support read preprocessing (adapter clipping, and merging). In terms of tools used for preprocessing, Trimmomatic [@Bolger2014-pm] is popular across the other pipelines but is not supported in nf-core/taxprofiler. Only sunbeam and nf-core/taxprofiler support complexity filtering to remove low sequence diversity reads. In fact within the development of sunbeam, the developers developed their own dedicated performant complexity filtering tool Komplexity [@Clarke2019-al], which may be of interest for adding to nf-core/taxprofiler if containers are created.\nMost pipelines support some form of host removal (only TAMA did not support this), and it is likely possible with Unipro UGENE through user customisation of the workflow. In all cases, this consists of mapping processed reads with an aligner and taking the off-target reads (as implemented in nf-core/taxprofiler), however StaG-mwc has an additional separate metagenomic host removal step with Kraken2.\nnf-core/taxprofiler supports by far the largest number of taxonomic classifers and profilers at 11 as of v1.1.0 - providing the greatest choice to users - with StaG-mwc offering 7, and the remaining pipelines only 3.\nOnly nf-core/taxprofiler and partly StaG-mwc explicitly supports running each profiler with multiple databases.nf-core/taxprofiler is the only pipeline that supports running an arbitrary number of different metagenomic profiler databases each with their own settings - making it useful for tool parameter comparison, testing different databases, or reducing the size of each database (e.g. per domain) to make it more flexibility for running on smaller computational infrastructure. StaG-mwc allows multiple references for their short-read alignment steps rather than the metagenomic profilers.\nFor output, nf-core/taxprofiler, StaG-mwc, and sunbeam (via an extension) support a singular run report for summarising all preprocessing step.\nOnly nf-core/taxprofiler and tama produce  standardised output for all taxonomic profilers (via TAXPASTA). However Unipro UGENE additionally offers a 'consensus' profile using WEVOTE [@Metwally2016-tm].\n\nTo summarise, many of the pipelines reviewed here offer similar functionality, with particularly StaG-mwc having a strong overlap with nf-core/taxprofiler. Thus, users in most cases will be able to select the pipeline depending on which pipeline framework they feel most comfortable with.\nHowever the advantages of nf-core/taxprofiler mainly comes from the offering of the greatest choice of tools, the benefits provided by Nextflow whereby it provides the greatest number of computational infrastructure types the pipeline can be executed on and container systems can be used to ensure reproducibility, and the support of the nf-core community due to the centralised pool of 'plug-and-play' modules to make it easier to update the pipeline overtime to add new tool.\n\nThe functionality offered by other pipelines not currently supported by nf-core/taxprofiler include sequencing saturation estimation (StaG-mwc), taxonomy-free composition comparison (StaG-mwc), functional profiling (StaG-mwc), _de novo_ assembly (sunbeam), and reference mapping (StaG-mwc, sunbeam).\nWe do not plan to support _de novo_ assembly or functional profiling in nf-core/taxprofiler as we feel this better served by other existing dedicated pipelines [e.g. @Uritskiy2018-ut;@Krakau2022-we].\n\nWe note there exists a range of other pipelines that also include some form of taxonomic classification.\nHowever often these pipelines have been developed with a different main purpose (e.g. Assembly and binning for nf-core/mag [@Krakau2022-we], MetaWRAP [@Uritskiy2018-ut], SqueezeMeta [@Tamames2018-zq], or MEDUSA [@Morais2022-rt]; Metagenomic read alignment with CCMetaGen [@Marcelino2020-rg] and Wochenende [@Rosenboom2022-bt]).\n\n### Development roadmap\n\nAn important advantage of nf-core/taxprofiler is that it is being developed within the nf-core community ([https://nf-co.re](https://nf-co.re)), that provides a strong and long term support for the continued community-based development and maintenance of the pipeline.\nIn this framework, we will continue to add additional preprocessing and metagenomic classification and profiling tools as they become established and as requested by the metagenomics community. For example, we feel inclusion of steps such as sequencing saturation estimation as already being performed by StaG-mwc would be beneficial to the nf-core/taxprofiler workflow (possibly with dedicated tools such as Nonpariel [@Rodriguez-R2018-rm] once gzipped FASTQ input is supported), and/or more performant complexity filtering tools such as Komplexity as offered by sunbeam (once software containers are offered for this tool).\nThis also applies to extend support to other sequencing platforms; nf-core/taxprofiler already supports Nanopore long-read data, however the use of long-read PacBio data for metagenomic data is growing in interest [@Portik2022-jp].\nWe are therefore considering adding dedicated preprocessing steps for this type of sequencing data.\n\nA remaining major challenge for metagenomics researchers (and not supported in the same workflow by any of the compared pipelines above) is the construction of databases for each profiling tool.\nGiven there still are no curated, high-quality 'gold standard' databases in metagenomics, and while nf-core/taxprofiler allows the profiling against multiple databases and settings in parallel, currently the pipeline still requires users to construct these manually and to supply to the pipeline.\nWhile we feel this is currently a reasonable investment as such databases can be repeatedly re-used, we are exploring the possibility to add an additional complementary workflow in the pipeline to allow automated database construction of all classification tools, given a set of FASTA reference files.\n\nFinally, once an overall taxonomic profile is generated, researchers often wish to validate hits through more sensitive and accurate methods such as with read-mapping alignment.\nWhile read alignment is supported by other pipelines such as StaG-mwc, this happens in-parallel to the taxonomic profiling and requires prior expectation of which reference genomes to map against.\nInstead, nf-core/profiler could be easily extended to have a validation step similar to that of the ancient DNA metagenomic pipeline aMeta [@Pochon2022-hj] where, utilising Nextflow's execution parallelism, the input sequences could be aligned back to the reference genomes of only those species with hits from the taxonomic classification with dedicated accurate short- or long-read aligners.\nIn addition to the more precise classification, post-classification read-alignment could also be particularly useful for researchers in palaeogenomics who wish to use other tools other than KrakenUniq for initial classification (as in aMeta), where alignment information can be used to authenticate ancient DNA within their samples but also in clinical metagenomics to identify potential pathogens at a much finer resolution (e.g. down to strain level).\n\n<!-- TODO additional post-processing steps? e.g. decontamination estimates? -->\n\nAnother motivation for developing nf-core/taxprofiler, despite the large number of existing metagenomics pipelines is by establishing a taxonomic profiling pipeline within the nf-core ecosystem, it is possible to begin building both standalone but also an integrated suite of powerful interconnected pipelines for the major stages of metagenomic workflows.\nExisting microbial- and metagenomics- related pipelines within the nf-core initiative include nf-core/ampliseq, nf-core/mag, and nf-core/funcscan.\nWe expect over time the ability to link inputs and outputs of each workflow to develop comphrensive metagenomic analyses, while still maintaing powerful standalone pipelines, providing maximal user choice.\n\n## Conclusion\n\nnf-core/taxprofiler is an accessible, efficient, and scalable pipeline for metagenomic taxonomic classification and profiling that can be executed on anywhere from laptops to the cloud.\nOffering, to our knowledge, the largest number of taxonomic profilers across similar pipelines, it provides flexibility for users not just on choice of profiling tool but also with databases and database settings, with any number being able to be supplied to the pipeline in a single run.\nWe hope that through detailed documentation and a range of execution options, nf-core/taxprofiler will make reproducible and high-throughput metagenomics more accessible for a wide range of disciplines.\n\n<!-- TODO make this last sentence better, it's a bit poop -->\n\n## Data Availability\n\nAll data used in this publication <!-- TODO : Version 2 of preprint -->\n\n## Code Availability\n\nnf-core/taxprofiler source code is available on GitHub at [https://github.com/nf-core/taxprofiler](https://github.com/nf-core/taxprofiler), and each release is archived on Zenodo (latest version DOI: [10.5281/zenodo.7728364](https://doi.org/10.5281/zenodo.7728364))\n\nThe version of the pipeline described in this paper is version (1.1.0) (release specific Zenodo archive DOI: [10.5281/zenodo.8358147](https://doi.org/10.5281/zenodo.8358147))\n\n## Supplementary Data\n\n| Sequence Matching Type | Primary Algorithm | Reference Type | Method         | Tool       |\n|------------------------|-------------------|----------------|----------------|------------|\n| Nucleotide             | k-mer based       | whole-genome   | classifier     | Kraken2    |\n| Amino Acid             | k-mer based       | whole-genome   | classifier     | Kaiju      |\n| Nucleotide             | k-mer based       | whole-genome   | profiler       | Bracken    |\n| Nucleotide             | k-mer based       | whole-genome   | profiler       | KrakenUniq |\n| Nucleotide             | k-mer based       | whole-genome   | profiler       | ganon      |\n| Nucleotide             | k-mer based       | whole-genome   | profiler       | KMCP       |\n| Nucleotide/Amino Acid  | alignment based   | whole-genome   | classifier     | MALT       |\n| Amino Acid             | alignment based   | whole-genome   | classifer      | DIAMOND    |\n| Nucleotide             | alignment based   | whole-genome   | profiler       | Centrifuge |\n| Nucleotide             | alignment based   | marker-gene    | profiler       | MetaPhlAn  |\n| Nucleotide             | alignment based   | marker-gene    | profiler       | mOTUS      |\n\n: List of nf-core/taxprofiler supported taxonomic/classifiers profilers as of version 1.1 and their approximate method and supported input database types.\nSequencing matching type refers to which 'molecular alphabet' is primarily used for matching between a query (read) and a reference (genome/gene).\nPrimary algorithm refers to the algorithm type used for sequencing matching.\nReference type refers to the typical sequence type used in database construction of the tool.\nMethod refers to whether the tool performs just read classification (classifier) or additionally abundance estimation (profiler) {#tbl-tool-summaries}\n\n## Acknowledgments\n\nWe thank Prof. Christina Warinner and the Microbiome Sciences group MPI-EVA for original discussions that lead to the pipeline.\nWe are also grateful for the nf-core community for the original and ongoing support in the development in the pipeline, in particular for the contributions by Lauri Mesilaakso, Jianhong Ou, and Rafał Stępień.\n\n## Funding\n\nS.S. and L.A-L. were supported by Rapid establishment of comprehensive laboratory pandemic preparedness – RAPID-SEQ.\nThis material is based upon work supported by the U.S. Department of Agriculture, Agricultural Research Service, under agreement No. 58-3022-0-001 (T.A.C II).\nM.B. and J.A.F.Y were supported by the Max Planck Society.\nJ.A.F.Y was supported by the Werner Siemens-Stiftung (\"Paleobiotechnology\", Awarded to Prof. Pierre Stallforth and Prof. Christina Warinner).\n\n## References\n\n[^1]: For an 'infamous' case of adapter sequences in a published eukaryotic genome, see the following blog posts\n\n    Graham Etherington: [https://web.archive.org/web/20201219022000/http://grahametherington.blogspot.com/2014/09/why-you-should-qc-your-reads-and-your.html?m=1](https://web.archive.org/web/20201219022000/http://grahametherington.blogspot.com/2014/09/why-you-should-qc-your-reads-and-your.html?m=1)why-you-should-qc-your-reads-and-your.html\n    Sixing Huang: [https://web.archive.org/web/20220904205331/https://dgg32.medium.com/carp-in-the-soil-1168818d2191](https://web.archive.org/web/20220904205331/https://dgg32.medium.com/carp-in-the-soil-1168818d2191)\n\n    (Accessed 2023-08-25)\n\n[^2]: As demonstrated in this blogpost from Paweł Przytuła: [https://web.archive.org/web/20230320223436/https://appsilon.com/reproducible-research-when-your-results-cant-be-reproduced/](https://web.archive.org/web/20230320223436/https://appsilon.com/reproducible-research-when-your-results-cant-be-reproduced/) (Accessed 2023-08-25)\n","srcMarkdownNoYaml":"\n\n## Abstract\n\nMetagenomic classification tackles the problem of characterising the taxonomic source of all DNA sequencing reads in a sample.\nA common approach to address the differences and biases between the many different taxonomic classification tools is to run metagenomic data through multiple classification tools and databases.\nThis, however, is a very time-consuming task when performed manually - particularly when combined with the appropriate preprocessing of sequencing reads before the classification.\n\nHere we present nf-core/taxprofiler, a highly parallelised taxonomic classification and processing pipeline that allows for automated and simultaneous classification and/or profiling of both short- and long-read metagenomic sequencing libraries against a large number of taxonomic classifiers and profilers as well as databases within a single pipeline run.\nImplemented in Nextflow and as part of the nf-core initiative, the pipeline benefits from high levels of scalability and portability, allowing for large and small projects on a wide range of computing infrastructure, as well as best-practise software development and community support to ensure longevity and adaptability of the pipeline, keeping up with the field of metagenomics.\n\n## Introduction\n\nShotgun metagenomics offers strong benefits to the taxonomic classification of DNA samples over targeted approaches [@Eloe-Fadrosh2016-gz;@Breitwieser2019-ys].\nWhile metabarcoding approaches targeting the 16S rRNA or other marker genes are widely due to low cost and large, diverse reference databases [@Yilmaz2014-js;@Lynch2015-mz], metagenomic approaches have been gaining popularity with the increasingly lower costs of shotgun sequencing.\nThese metagenomic analyses have been shown to provide similar resolution on microbial genomes during taxonomic classification [@Hillmann2018-ud], with the added benefit of having greater reusability potential of the data, via whole genome reconstruction and also functional classification of metagenomics [@Sharpton2014-wy;@Quince2017-bl].\n\nTaxonomic classifiers (sometimes referred to as taxonomic binners) consists of identifying the original 'taxonomic source' of a given DNA sequence [@Ye2019-fl;@Meyer2022-dg;@Govender2022-td].\nIn metagenomics, this typically consists of comparing millions of DNA sequences against hundreds or thousands of reference genomes either via alignment or 'k-mer matching' [@Sharpton2014-wy;@Sun2021-tq], with the most close match being considered the most likely original 'source' organism of that sequence.\nTaxonomic profilers additionally will also try to infer species abundance of the organism in the original sample, based on the sequence abundance [@Nayfach2016-ej].\nWe will use classifiers and profilers interchangeably throughout the publication.\n\nDue to the scale of the problem, taxonomic profiling remains an 'unresolved problem' in bioinformatics.\nHaving to identify the original source of many sequences out of many reference genomes, but in an _efficient_ manner, is understandably a difficult problem.\nTherefore a plethora of tools have been developed to address this challenge, all with their own biases and specific contexts [@Sczyrba2017-ma;@Meyer2022-dg].\nAdditionally, each tool often produces tool-specific output formats making it difficult to efficiently cross compare results.\nThus, no established 'gold standard' method currently exists.\n\nOne solution to address the range of different tools is to run all of them in parallel, and cross compare the results.\nThis can be useful both for benchmarking studies [e.g. @Sczyrba2017-ma;@Meyer2022-dg], but also to build consensus profiles whereby confidence of a particular taxonomic identification can be increased when it is detected by multiple tools [@McIntyre2017-td;@Ye2019-fl].\n\nA second challenge in taxonomic classification is a question of databases. As with tools, there is no one set 'gold standard' database.\nDifferent questions and contexts may require different databases, such as when a researcher wants to search for both bacterial and virus species in samples, and as an extension of this, taxonomic classifiers may need different settings for each database.\nFurthermore, as genomic sequencing becomes cheaper and more efficient, the number of publicly available reference genomes are rapidly increasing [@Nasko2018-cl], making the size of databases taxonomic classifiers also much larger and often outpacing the computational capacity available to researchers.\nIn fact, while this was one of the main motivations behind classifiers such as Kraken2 [@Wood2019-mf], these algorithmic techniques are already becoming insufficient [@Wright2023-yr].\n\nFinally, with the decrease of costs, the possibility for larger and larger metagenome sequencing datasets increases, leading to increasing sample sizes in studies, as exemplified by the doubling of the number of metagenomes on the European Bioinformatic Institute's MGnify database in two years [@Mitchell2019-kt].\nAltogether this highlights the need for methods to efficiently profile many samples using many tools.\nManually setting up bioinformatic jobs for classification tasks for each database and settings against different tools on traditional academic computing infrastructure (e.g. high performance computing clusters or 'HPC' clusters) can be very tedious.\nAdditionally, particularly for very large sample sets, there is increasing use of cloud platforms that have greater scalability than traditional HPCs.\nBeing able to reliably and reproducibly execute taxonomic classification tasks across infrastructure with minimal intervention would therefore be a boon for the metagenomics field.\n\nHere we present nf-core/taxprofiler, a pipeline designed to allow users to efficiently and simultaneously taxonomically classify and profile short- and long-read sequencing data against multiple tools and databases in a single pipeline run.\nnf-core/taxprofiler utilises Nextflow [@Di_Tommaso2017-xu] to ensure efficiency, portability, and scalability, and has been developed within the nf-core initiative of Nextflow pipelines [@Ewels2020-vi] to ensure high quality coding practises and user accessibility, including detailed documentation and a graphical-user-interface (GUI) execution interface.\n\n## Implementation\n\nnf-core/taxprofiler aims to facilitate three main steps of a typical shotgun metagenomic workflow [@Chiu2019-mv].\nTaking in short- (e.g. Illumina) or long-read (e.g. Nanopore) FASTQ or FASTA files, it can (1) perform a range of appropriate read preprocessing steps, (2) perform taxonomic classification and profiling against a range of different tools depending on user preferences, and finally (3) perform post-classification aggregation and standardisation of the resulting profiles with the possibility of visualisation to the outputs (@fig-workflow-diagram).\nAll relevant preprocessing statistics are displayed in an interactive and dynamic MultiQC report [@Ewels2020-vi].\n\n![Visual overview of the nf-core/taxprofiler workflow. nf-core/taxprofiler can take in FASTQ (short or long reads) or FASTA files (long reads), that will optionally go through sequencing quality control (e.g. with FastQC), read preprocessing (e.g. removal of adapters), complexity filtering, host removal, and run merging before performing taxonomic classification and/or profiling with a user-selected range of tools and databases. Output from all classifiers and profilers are standardised into a common taxon table format, and when supported visualisations of the profiles are generated.](taxprofiler_tube.png){#fig-workflow-diagram fig-alt=\"Visual overview of the nf-core/taxprofiler workflow. nf-core/taxprofiler can take in FASTQ (short or long reads) or FASTA files (long reads), that will optionally go through sequencing quality control, read preprocessing, complexity filtering, host removal, and run merging before going into taxonomic classification and/or profiling with a user-selected range of tools and databases. Output from all classifiers and profilers are additionally standardised into a common taxon table format and some with visualisation of profiles.\"}\n\n### Input and Execution\n\nThe pipeline can be executed via typical Nextflow commands, or using the standard nf-core 'launch' graphical-user-interface (GUI) ([https://nf-co.re/taxprofiler/launch](https://nf-co.re/taxprofiler/launch)), making the pipeline accessible for both computationally experienced as well as less experienced researchers.\nIn addition to the general usage and parameter documentation of the pipeline (https://nf-co.re/taxprofiler).\nThe GUI offers immediate assistance and guidance to users on what each parameter does, both in short- and long-form, with long-form parameter descriptions additionally describing which tool-specific parameter(s) are being modified for each pipeline parameter ([@fig-launch-page]).\nThe GUI also includes controlled user input by providing strict drop-down lists and input validation prior execution of the pipeline to reduce the risk of typos and other mistakes (in contrast to the command-line interface (CLI) that only includes validation at pipeline run-time).\n\n![Screenshot of the nf-core pipeline launch graphical user interface with nf-core/taxprofiler options displayed. The web browser-based interface provides guidance for how to configure each pipeline parameter by providing both short and long help descriptions to help guide users in which contexts to configure each parameter. Additional elements such as radio buttons, drop down menus, and background regular expressions check for validity of input. When pressing launch, a prepared configuration file and command is provided that can be copied and pasted by the user into the terminal](taxprofiler_launchpage.png){#fig-launch-page fig-alt=\"Screenshot of the nf-core pipeline launch graphical user interface with nf-core/taxprofiler options displayed. The web browser-based interface provides guidance for how to configure each pipeline parameter by providing both short and long help descriptions to help guide users in which contexts to configure each parameter. Additional elements such as radio buttons, drop down menus, and background regular expressions check for validity of input. When pressing launch, a prepared configuration file and command is provided that can be copied and pasted by the user into the terminal\"}\n\nAn example nf-core command line execution of the pipeline can be seen in figure (@lst-example-cmd), where two input files are supplied: one file specifying paths of FASTQ files of metagenomic samples and necessary metadata for preprocessing (such as sample ID and sequencing platform), and the second file specifying paths to the user-defined databases with per-database classification parameters.\nVarious parameters are available to optionally turn on different preprocessing steps, and provide additional configurations such as tool selection and value options.\nNote that even if a user supplies a given database in the database input sheet, the corresponding profiling tool must still be activated with the corresponding pipeline parameter (e.g. `--run_kraken2`).\nPer-classifier flags are also available for the optional saving of additional non-profile output files.\n\n```{#lst-example-cmd .bash lst-cap=\"Example nf-core/taxprofiler command for running short-read quality control, removal of host DNA and executing the k-mer based Kraken2 and marker gene alignment MetaPhlAn3 tools.\"}\n$ nextflow run nf-core/taxprofiler -r 1.1.0 \\\n-profile singularity,<institute> \\\n--input <samplesheet.csv> --databases <database.csv> \\\n--perform_shortread_qc  --shortread_qc_minlength 20 --preprocessing_qc_tool falco \\\n--run_host_removal --hostremoval_reference 'host_genome.fasta' \\\n--run_kraken2 --kraken2_save_reads \\\n--run_metaphlan3 \\\n--run_krona \\\n--run_profile_standardisation \\\n```\n\nAll nf-core pipelines are strictly versioned (specified with the Nextflow `-r` flag), and to ensure reproducibility, each version of the pipeline has a fixed set of software used for each step of the pipeline.\nThe fixed set of software are controlled through the use of the conda package manager and containers (e.g., Docker, Apptainer [previously known as Singularity]) from the stable Bioconda [@Gruning2018-vr] and BioContainers [@Da_Veiga_Leprevost2017-gl] repositories.\nThis, coupled with the intrinsic Nextflow ability to execute on most infrastructure whether that is a local laptop (resource requirements permitting), traditional HPC, as well across common cloud providers also makes nf-core/taxprofiler a very portable pipeline that can be used across many contexts.\n\n### Preprocessing\n\nPreprocessing steps in nf-core/taxprofiler are aimed at removing laboratory and sequencing artefacts that may influence taxonomically profiling, either for computing resource consumption and/or false-positive or false-negative classification reasons.\nFirst sequencing quality control with FastQC [@Andrews2010-pd] or Falco [@De_Sena_Brandine2021-pi] is carried out.\nFalco was included in for reduced memory requirements, in particular for long reads sequencing.\nArtificial library adapter sequences added during sequencing reduces accuracy during alignment by reducing sequence specificity, and in some cases, may result in false-positive hits due to adapter sequence contamination in reference genomes [@Schaffer2018-be;@Breitwieser2018-xg] [^1].\nAdditionally, the paired-end merging may provide longer sequences that will allow more specific classification when paired-end alignment is not supported by a given classifier.\nFor these tasks nf-core/taxprofiler can apply either fastp [@Chen2018-vg] or AdapterRemoval2 [@Schubert2016-qv] for short-reads, and currently Porechop [@Wick2017-cn] for Oxford Nanopore long-read data.\nFor both short- and long-reads FastQC or Falco is run again to allow assessment on the performance of the adapter removal and/or pair-merging step.\n\nLow complexity sequences, e.g. sequences containing long stretches mono- or di-nucleotide repeats provide little specific genetic information that contribute to taxonomic identification, as they can align to many different reference genomes [@Schmieder2011-ea;@Clarke2019-al].\nIncluding such reads during taxonomic profiling can increase run-time and memory usage for little gain, as during lowest-common-ancestor (LCA) classification steps they will be assigned to high-level taxonomic levels (e.g. Kingdom).\nnf-core/taxprofiler performs removal of these reads through complexity filtering algorithms as provided by fastp, BBDuk [@Bushnell2022-pf], or PRINSEQ++ [@Cantu2019-lh].\nLong read sequences often do not have such reads as lengths are sufficient enough to capture greater sequence diversity - but it is sometimes desired to only classify reads longer than a certain length - as these provide more precise taxonomic information [@Dilthey2019-ps;@Portik2022-jp].\nTherefore, nf-core/taxprofiler can remove reads shorter than a user-defined length using Filtlong.\n\nRemoving host DNA is another common preprocessing step in metagenomic studies.\nThis can help speed up run-time, particularly in microbiome studies, where detection of microbes are of interest.\nFurthermore, host-contamination of reference genomes in public databases is common [@Longo2011-qd;@Kryukov2016-my;@Breitwieser2019-iz] and therefore the removal of such sequences can also decrease the risk of false positive taxonomic assignment.\nTo remove multiple hosts or other sequences, all reference genomes can be combined into a single FASTA reference file.\nShort-read host removal can be carried out with Bowtie2 [@Langmead2012-ik;@Langmead2019-ej] and minimap2 [@Li2018-qq] for long-reads, both in combination with SAMtools [@Li2009-wy;@Danecek2021-gj], where reads are aligned against the reference genome and the off-target (unaligned) reads are then converted back to FASTQ format for classification.\n\nFinally, nf-core/taxprofiler can optionally perform run merging where libraries have been sequenced over multiple lanes to generate one profile per sample or library.\nThe final set of reads used for profiling can be optionally saved for downstream re-use.\n\nThroughout all steps, relevant statistics and log files are generated and used both for the final pipeline run report as well as saved into the results directory of the pipeline run for further inspection where necessary.\n\n### Profiling\n\nThere are many types of metagenomic profiling techniques, from profiling against whole-genome references with alignment or k-mer based approaches, to methods involving alignment to species-specific marker-gene families [@Quince2017-bl,@Ye2019-fl].\nnf-core/taxprofiler aims to support and include all established classification or profiling tools as requested by the community.\nThe choice of tools used in a pipeline run is up to the user, with a tool being executed when both the corresponding database and `--run_<tool>` flag is provided.\nSpecific classification settings for each tool and database are specified in the database CSV input sheet.\nSome tools also have pipeline level command-line flags for controlling certain aspects of output files.\n\nAs of version 1.1.0, the following classifiers and profilers are available: Kraken2 [@Wood2019-mf], Bracken [@Lu2017-vc], KrakenUniq [@Breitwieser2018-xg], Centrifuge [@Kim2016-qc], MALT [@Vagene2018-px], DIAMOND [@Buchfink2021-ks], Kaiju [@Menzel2016-xy], MetaPhlAn [@Blanco-Miguez2023-cq], mOTUs [@Ruscheweyh2022-hn], ganon [@Piro2020-es], KMCP [@Shen2023-bk]. [@tbl-tool-summaries] in Supplementary Data summarises the category and reference database type for each tool.\n\nBy default, nf-core/taxprofiler produces the per-sample main taxonomic classification profile from a tool or a tool's report generation tool.\nThe output is normally in the form of counts per reference sequencing, with additional statistics about the hits of a particular organism (estimated abundance, taxonomic level etc.).\nUsers can also optionally request output of per-read classification output, and output such as classified and unclassified reads in FASTQ format, where supported.\n\nThe pipeline provides high efficiency, particularly during the metagenomic classification stage, through the inherent parallelisation provided by Nextflow.\nWhile metagenomic classification is comparatively computationally intensive (in terms of memory and execution time; due to a combination of sequencing depth and number of reference genomes), Nextflow automatically optimises the execution order of all the steps in pipeline, maximising the number parallel running of multiple profilers and/or databases at any given time point, as far as the available computational resources allow.\nFor local machines such as laptops or desktops, Nextflow will automatically detect all available computational sources but this is customisable using custom Nextflow configuration files.\nFor HPC and cloud infrastructure, users typically have to define the computational infrastructural environment the pipeline is being executed on (CPU or memory limitations, queues, instance types etc.).\nTo facilitate the pipeline set-up, nf-core/taxprofiler supports pre-defined centralised generic and pipeline-specific institutional Nextflow configurations as provided by nf-core/configs ([https://nf-co.re/configs](https://nf-co.re/configs); more than 90 institutions at the time of writing).\nHowever, users are still welcome to supply their own custom configuration files, further refining computational limitations or execution specifications.\n\n### Post-profiling\n\nIn metagenomic studies, it is common practise to compare the profiles among many samples, and the results of multiple profiles are normally stored in 'taxon tables', i.e, counts per reference (rows), for each sample (columns).\nWhen available, nf-core/taxprofiler supports the option to produce the 'native' taxon table of each classification tool when multiple samples are run.\n\nOne of the challenges that researchers face when comparing multiple taxonomic classifiers or profilers is the heterogenous output formats that are produced, and often requires custom parser and merging scripts for each tool to standardise.\nTo facilitate more user-friendly cross-comparison between tools, nf-core/taxprofiler utilises the TAXPASTA tool [@Beber2023-hk] to generate standardised profiles and generate multi-sample tables.\n\nSummary statistics for the entire pipeline are visualised and displayed in a customisable MultiQC report [@Ewels2020-vi], when supported, to support user quality control of data and pipeline runs.\nKrona plots [@Ondov2011-se] can also optionally be generated for supported tools to help provide further visualisation of taxonomic profiles.\n\n### Output\n\nTo summarise, the main default output from nf-core/taxprofiler are both classifier 'native' and standardised single- and multi-sample taxonomic profiles with counts per-taxon and an interactive MultiQC run report with all run statistics, in addition to the raw log files themselves where available.\n\nThe MultiQC run report displays statistics and summary visualisations for all steps of the pipeline where possible, lists of versions for all tools of each step of the pipeline, and provides a dynamically-constructed text for the recommendeded 'methods' text for reporting how the pipeline was executed (including relevant citations) that users can use in their own publications.\n\nOptional outputs can include other types of profiles (e.g. per read classification) and in other formats as produced by the tools themselves, as well as raw reads from preprocessing steps and output visualisations from Krona.\nNextflow resource usage and trace reports are also by default produced for users to check pipeline performance.\n\n<!--\n\nTODO: Version 2 of preprint\n\n## Use Cases and Benchmarking\n\nTo demonstrate different uses of nf-core/taxprofiler, we ran the pipeline on datasets of XXXX  from XXX , on a XXXX .\n\nRun metric can be seen in Figure XXXXXX .\n\n-->\n\n## Discussion\n\n### Comparison with other solutions\n\nnf-core/taxprofiler has been specifically developed for the analysis of _metagenomic_ data.\nWhile other types of taxonomic profiling data such as 16S amplicon sequencing are well established fields with a range of popular high-quality and best-practise tools pipelines (e.g. [@Blanco-Miguez2023-cq;@Schloss2009-vk]) and databases [@DeSantis2006-cm;@Yilmaz2014-js], whereas 'gold standard' tools and databases for metagenomics remains are much less established - thus the need for highly-multiplexed classification is more desirable for the newer metagenomics methods.\nDespite this, tools such as METAXA2 [@Bengtsson-Palme2015-ar] that use shotgun sequencing reads to recover 16S sequences from metagenomic samples.\n\nA range of pipelines already exist for taxonomic profiling, however each have their own particular purpose and abilities.\nHere we compare the functionality of nf-core/taxprofiler against four other recently published or released pipelines, selected based on their similarity of purpose to nf-core/taxprofiler.\nWe searched Google Scholar for open-source pipelines published or released in the last 5 years (at the time of writing, since 2018) that were designed primarily for metagenomic classification screening, that supported at least 2 classifiers, had at laest one preprocessing step and was not specificaly targeted at read classification of specific domains of taxa (e.g. virus or bacteriophage only).\nWe also included an additional pipeline at the recommendations of the authors of the pipeline due to the functional overlap to nf-core/taxprofiler. We then evaluted the pipelines based on their publications and documentation for typical metagenomic profiling workflow steps, and a range criteria related to expectations of modern bioinformatic workflows that can be summarised in the following four criteria: reproducibility, accessibility, scalability, and portability [@Wratten2021-es]. After searching, we selected the following pipelines for comparison with nf-core/taxprofiler: sunbeam [v4; @Clarke2019-al], Unipro UGENE [v48; @Rose2019-jf], TAMA [githash: 3a22c8f; @Sim2020-ja], and StaG-mwc [0.7.0; @Boulund2023-ct].\n\nIn terms of accessibility, all pipelines have documentation describing the installation steps, usage instructions, and output files.\nHowever, there are varying levels of detail and comprehensiveness. In particular, StaG-mwc and nf-core/taxprofiler have the most detailed descriptions of all possible output files for every supported module, whereas Unipro UGENE and sunbeam have very minimal to possibly unfinished output documentation.\nFor execution options, most of the pipelines provide CLI execution, except for Unipro UGENE offers only GUI-based pipeline set-up (despite a command-line execution of the GUI generated configuration). In particular, nf-core/taxprofiler is the only pipeline providing both CLI and GUI interfaces for pipeline run execution.\n\nCriteria covering portability also overlaps with accessibility, as it implies the options and ease that different users can run on different types of computing infrastructure, whether that is on their own laptop, on a HPC cluster or in the cloud.\nUnipro UGENE is the only pipeline that supports execution on all three major operating systems (Linux, OSX, Windows), whereas StaG-mwc and nf-core/taxprofiler can be run on unix operating systems, and sunbeam and TAMA are only being supported on Linux.\nWhile all pipelines support 'local' machine execution (e.g. personal laptops or desktops), a large portion of academic users execute computationally intensive bioinformatic tasks on HPC clusters.\nIn these contexts, pipeline task submissions are normally managed by job schedulers, thus integration with schedulers is an important criteria for running large multi-step and parallelised pipelines.\nThe three pipelines leveraging workflow managers (Snakemake [@Molder2021-et] and Nextflow) support integration with schedulers (StaG-mwc, sunbeam, and nf-core/taxprofiler) with nf-core/taxprofiler supporting the most by far ([>10 scheduling systems](https://www.nextflow.io/docs/latest/executor.html)) as natively offered by Nextflow. This allows the greatest possible choice or users in terms of which HPC infrastructure they could execute their pipeline on.\nAs an extension of this, only nf-core/taxprofiler has explicitly described support for cloud computing (e.g. AWS or Microsoft Azure), again maximising user choice and accessibility when it comes to running the pipeline.\n\nIn terms of scalability, the aforementioned integration with schedulers and cloud computing support implicit maximises efficiency and parallellisation of pipeline runs, providing good scalability for varying numbers of input files and steps in the pipeline. Again, the three workflow manager based pipelines provide scalability, whereas there is no mention neither Unipro UGENE nor TAMA in reference to parallel task execution. Furthemore, all pipelines except TAMA, allowed per-process customisation of computational resources, something critical for maximising efficient scalability to ensure only the necessary resources for a given step of a pipeline are requested.\n\nIn terms of reproducibility, all five pipelines are good at ensuring reproducibility in terms of pipeline and software versioning (allowing re-execution of pipeline runs using the same software), with only tama not having stable versioned releases.\nHowever, installing software manually across different infrastructures can result in variability in the execution of each software [^2] [@Di_Tommaso2017-xu].The current most popular solution to the problem of inconsistent software environments is to use container engines such as Docker or Apptainer. These allow 'snapshotting' of a operating system and all configuration and fixed versions of all software required for the pipeline.\nOnly Unipro UGENE does not document the use of a container system with nf-core/taxprofiler offering the biggest choice for users courtsey of Nextflow (6 different engine systems at the time of writing).\n\nFinally we compared metagenomics related functionality between the pipelines. All pipelines support short-read FASTQ input, but only nf-core/taxprofiler explicitly reports long-read support, while the documentation in Unipro UGENE states that assembled contigs are possible input to some of the profilers.\nAll pipelines support read preprocessing (adapter clipping, and merging). In terms of tools used for preprocessing, Trimmomatic [@Bolger2014-pm] is popular across the other pipelines but is not supported in nf-core/taxprofiler. Only sunbeam and nf-core/taxprofiler support complexity filtering to remove low sequence diversity reads. In fact within the development of sunbeam, the developers developed their own dedicated performant complexity filtering tool Komplexity [@Clarke2019-al], which may be of interest for adding to nf-core/taxprofiler if containers are created.\nMost pipelines support some form of host removal (only TAMA did not support this), and it is likely possible with Unipro UGENE through user customisation of the workflow. In all cases, this consists of mapping processed reads with an aligner and taking the off-target reads (as implemented in nf-core/taxprofiler), however StaG-mwc has an additional separate metagenomic host removal step with Kraken2.\nnf-core/taxprofiler supports by far the largest number of taxonomic classifers and profilers at 11 as of v1.1.0 - providing the greatest choice to users - with StaG-mwc offering 7, and the remaining pipelines only 3.\nOnly nf-core/taxprofiler and partly StaG-mwc explicitly supports running each profiler with multiple databases.nf-core/taxprofiler is the only pipeline that supports running an arbitrary number of different metagenomic profiler databases each with their own settings - making it useful for tool parameter comparison, testing different databases, or reducing the size of each database (e.g. per domain) to make it more flexibility for running on smaller computational infrastructure. StaG-mwc allows multiple references for their short-read alignment steps rather than the metagenomic profilers.\nFor output, nf-core/taxprofiler, StaG-mwc, and sunbeam (via an extension) support a singular run report for summarising all preprocessing step.\nOnly nf-core/taxprofiler and tama produce  standardised output for all taxonomic profilers (via TAXPASTA). However Unipro UGENE additionally offers a 'consensus' profile using WEVOTE [@Metwally2016-tm].\n\nTo summarise, many of the pipelines reviewed here offer similar functionality, with particularly StaG-mwc having a strong overlap with nf-core/taxprofiler. Thus, users in most cases will be able to select the pipeline depending on which pipeline framework they feel most comfortable with.\nHowever the advantages of nf-core/taxprofiler mainly comes from the offering of the greatest choice of tools, the benefits provided by Nextflow whereby it provides the greatest number of computational infrastructure types the pipeline can be executed on and container systems can be used to ensure reproducibility, and the support of the nf-core community due to the centralised pool of 'plug-and-play' modules to make it easier to update the pipeline overtime to add new tool.\n\nThe functionality offered by other pipelines not currently supported by nf-core/taxprofiler include sequencing saturation estimation (StaG-mwc), taxonomy-free composition comparison (StaG-mwc), functional profiling (StaG-mwc), _de novo_ assembly (sunbeam), and reference mapping (StaG-mwc, sunbeam).\nWe do not plan to support _de novo_ assembly or functional profiling in nf-core/taxprofiler as we feel this better served by other existing dedicated pipelines [e.g. @Uritskiy2018-ut;@Krakau2022-we].\n\nWe note there exists a range of other pipelines that also include some form of taxonomic classification.\nHowever often these pipelines have been developed with a different main purpose (e.g. Assembly and binning for nf-core/mag [@Krakau2022-we], MetaWRAP [@Uritskiy2018-ut], SqueezeMeta [@Tamames2018-zq], or MEDUSA [@Morais2022-rt]; Metagenomic read alignment with CCMetaGen [@Marcelino2020-rg] and Wochenende [@Rosenboom2022-bt]).\n\n### Development roadmap\n\nAn important advantage of nf-core/taxprofiler is that it is being developed within the nf-core community ([https://nf-co.re](https://nf-co.re)), that provides a strong and long term support for the continued community-based development and maintenance of the pipeline.\nIn this framework, we will continue to add additional preprocessing and metagenomic classification and profiling tools as they become established and as requested by the metagenomics community. For example, we feel inclusion of steps such as sequencing saturation estimation as already being performed by StaG-mwc would be beneficial to the nf-core/taxprofiler workflow (possibly with dedicated tools such as Nonpariel [@Rodriguez-R2018-rm] once gzipped FASTQ input is supported), and/or more performant complexity filtering tools such as Komplexity as offered by sunbeam (once software containers are offered for this tool).\nThis also applies to extend support to other sequencing platforms; nf-core/taxprofiler already supports Nanopore long-read data, however the use of long-read PacBio data for metagenomic data is growing in interest [@Portik2022-jp].\nWe are therefore considering adding dedicated preprocessing steps for this type of sequencing data.\n\nA remaining major challenge for metagenomics researchers (and not supported in the same workflow by any of the compared pipelines above) is the construction of databases for each profiling tool.\nGiven there still are no curated, high-quality 'gold standard' databases in metagenomics, and while nf-core/taxprofiler allows the profiling against multiple databases and settings in parallel, currently the pipeline still requires users to construct these manually and to supply to the pipeline.\nWhile we feel this is currently a reasonable investment as such databases can be repeatedly re-used, we are exploring the possibility to add an additional complementary workflow in the pipeline to allow automated database construction of all classification tools, given a set of FASTA reference files.\n\nFinally, once an overall taxonomic profile is generated, researchers often wish to validate hits through more sensitive and accurate methods such as with read-mapping alignment.\nWhile read alignment is supported by other pipelines such as StaG-mwc, this happens in-parallel to the taxonomic profiling and requires prior expectation of which reference genomes to map against.\nInstead, nf-core/profiler could be easily extended to have a validation step similar to that of the ancient DNA metagenomic pipeline aMeta [@Pochon2022-hj] where, utilising Nextflow's execution parallelism, the input sequences could be aligned back to the reference genomes of only those species with hits from the taxonomic classification with dedicated accurate short- or long-read aligners.\nIn addition to the more precise classification, post-classification read-alignment could also be particularly useful for researchers in palaeogenomics who wish to use other tools other than KrakenUniq for initial classification (as in aMeta), where alignment information can be used to authenticate ancient DNA within their samples but also in clinical metagenomics to identify potential pathogens at a much finer resolution (e.g. down to strain level).\n\n<!-- TODO additional post-processing steps? e.g. decontamination estimates? -->\n\nAnother motivation for developing nf-core/taxprofiler, despite the large number of existing metagenomics pipelines is by establishing a taxonomic profiling pipeline within the nf-core ecosystem, it is possible to begin building both standalone but also an integrated suite of powerful interconnected pipelines for the major stages of metagenomic workflows.\nExisting microbial- and metagenomics- related pipelines within the nf-core initiative include nf-core/ampliseq, nf-core/mag, and nf-core/funcscan.\nWe expect over time the ability to link inputs and outputs of each workflow to develop comphrensive metagenomic analyses, while still maintaing powerful standalone pipelines, providing maximal user choice.\n\n## Conclusion\n\nnf-core/taxprofiler is an accessible, efficient, and scalable pipeline for metagenomic taxonomic classification and profiling that can be executed on anywhere from laptops to the cloud.\nOffering, to our knowledge, the largest number of taxonomic profilers across similar pipelines, it provides flexibility for users not just on choice of profiling tool but also with databases and database settings, with any number being able to be supplied to the pipeline in a single run.\nWe hope that through detailed documentation and a range of execution options, nf-core/taxprofiler will make reproducible and high-throughput metagenomics more accessible for a wide range of disciplines.\n\n<!-- TODO make this last sentence better, it's a bit poop -->\n\n## Data Availability\n\nAll data used in this publication <!-- TODO : Version 2 of preprint -->\n\n## Code Availability\n\nnf-core/taxprofiler source code is available on GitHub at [https://github.com/nf-core/taxprofiler](https://github.com/nf-core/taxprofiler), and each release is archived on Zenodo (latest version DOI: [10.5281/zenodo.7728364](https://doi.org/10.5281/zenodo.7728364))\n\nThe version of the pipeline described in this paper is version (1.1.0) (release specific Zenodo archive DOI: [10.5281/zenodo.8358147](https://doi.org/10.5281/zenodo.8358147))\n\n## Supplementary Data\n\n| Sequence Matching Type | Primary Algorithm | Reference Type | Method         | Tool       |\n|------------------------|-------------------|----------------|----------------|------------|\n| Nucleotide             | k-mer based       | whole-genome   | classifier     | Kraken2    |\n| Amino Acid             | k-mer based       | whole-genome   | classifier     | Kaiju      |\n| Nucleotide             | k-mer based       | whole-genome   | profiler       | Bracken    |\n| Nucleotide             | k-mer based       | whole-genome   | profiler       | KrakenUniq |\n| Nucleotide             | k-mer based       | whole-genome   | profiler       | ganon      |\n| Nucleotide             | k-mer based       | whole-genome   | profiler       | KMCP       |\n| Nucleotide/Amino Acid  | alignment based   | whole-genome   | classifier     | MALT       |\n| Amino Acid             | alignment based   | whole-genome   | classifer      | DIAMOND    |\n| Nucleotide             | alignment based   | whole-genome   | profiler       | Centrifuge |\n| Nucleotide             | alignment based   | marker-gene    | profiler       | MetaPhlAn  |\n| Nucleotide             | alignment based   | marker-gene    | profiler       | mOTUS      |\n\n: List of nf-core/taxprofiler supported taxonomic/classifiers profilers as of version 1.1 and their approximate method and supported input database types.\nSequencing matching type refers to which 'molecular alphabet' is primarily used for matching between a query (read) and a reference (genome/gene).\nPrimary algorithm refers to the algorithm type used for sequencing matching.\nReference type refers to the typical sequence type used in database construction of the tool.\nMethod refers to whether the tool performs just read classification (classifier) or additionally abundance estimation (profiler) {#tbl-tool-summaries}\n\n## Acknowledgments\n\nWe thank Prof. Christina Warinner and the Microbiome Sciences group MPI-EVA for original discussions that lead to the pipeline.\nWe are also grateful for the nf-core community for the original and ongoing support in the development in the pipeline, in particular for the contributions by Lauri Mesilaakso, Jianhong Ou, and Rafał Stępień.\n\n## Funding\n\nS.S. and L.A-L. were supported by Rapid establishment of comprehensive laboratory pandemic preparedness – RAPID-SEQ.\nThis material is based upon work supported by the U.S. Department of Agriculture, Agricultural Research Service, under agreement No. 58-3022-0-001 (T.A.C II).\nM.B. and J.A.F.Y were supported by the Max Planck Society.\nJ.A.F.Y was supported by the Werner Siemens-Stiftung (\"Paleobiotechnology\", Awarded to Prof. Pierre Stallforth and Prof. Christina Warinner).\n\n## References\n\n[^1]: For an 'infamous' case of adapter sequences in a published eukaryotic genome, see the following blog posts\n\n    Graham Etherington: [https://web.archive.org/web/20201219022000/http://grahametherington.blogspot.com/2014/09/why-you-should-qc-your-reads-and-your.html?m=1](https://web.archive.org/web/20201219022000/http://grahametherington.blogspot.com/2014/09/why-you-should-qc-your-reads-and-your.html?m=1)why-you-should-qc-your-reads-and-your.html\n    Sixing Huang: [https://web.archive.org/web/20220904205331/https://dgg32.medium.com/carp-in-the-soil-1168818d2191](https://web.archive.org/web/20220904205331/https://dgg32.medium.com/carp-in-the-soil-1168818d2191)\n\n    (Accessed 2023-08-25)\n\n[^2]: As demonstrated in this blogpost from Paweł Przytuła: [https://web.archive.org/web/20230320223436/https://appsilon.com/reproducible-research-when-your-results-cant-be-reproduced/](https://web.archive.org/web/20230320223436/https://appsilon.com/reproducible-research-when-your-results-cant-be-reproduced/) (Accessed 2023-08-25)\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"html-math-method":"katex","number-sections":true,"output-file":"taxprofiler-manuscript.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.433","title":"nf-core/taxprofiler: highly parallelised and flexible pipeline for metagenomic taxonomic classification and profiling","author":[{"name":"Sofia Stamouli","given":"Sofia","family":"Stamouli","orcid":"0009-0006-0893-3771","roles":["conceptualization","software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"Moritz E. Beber","given":"Moritz","family":"Beber","orcid":"0000-0003-2406-1978","roles":["conceptualization","software","editing"],"affiliations":[{"ref":"usb"}]},{"name":"Tanja Normark","given":"Tanja","family":"Normark","orcid":null,"roles":["software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"Thomas A. Christensen II","given":"Thomas A.","family":"Christensen II","orcid":"0000-0003-1219-9320","roles":["software","editing"],"affiliations":[{"ref":"ksu"}]},{"name":"Lili Andersson-Li","given":"Lili","family":"Andersson-Li","orcid":"0000-0002-6059-4192","roles":["software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"Maxime Borry","given":"Maxime","family":"Borry","orcid":"0000-0001-9140-7559","roles":["software","editing"],"affiliations":[{"ref":"eva"}]},{"name":"Mahwash Jamy","given":"Mahwash","family":"Jamy","orcid":null,"roles":["software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"nf-core community","url":"https://nf-co.re","email":"core@nf-co.re","roles":["software"],"affiliations":[{"ref":"xx"}]},{"name":"James A. Fellows Yates","given":"James A.","family":"Fellows Yates","orcid":"0000-0001-5585-6277","email":"james_fellows_yates@eva.mpg.de","corresponding":true,"roles":["conceptualization","project administration","software","supervision","writing","editing"],"affiliations":[{"ref":"eva"},{"ref":"hki"}]}],"affiliations":[{"id":"ki","name":"Department of Microbiology, Tumor and Cell Biology, Karolinkska Institutet","address":"Solnavägen 1","city":"Solna","state":"Stockholm","postal-code":17177,"country":"Sweden"},{"id":"kuh","name":"Department of Clinical Microbiology, Karolinska University Hospital","address":"Anna Steckséns gata 41","city":"Solna","state":"Stockholm","postal-code":17177,"country":"Sweden"},{"id":"usb","name":"Unseen Bio ApS","address":"Fruebjergvej 3","city":"Copenhagen","state":"Capital Region","postal-code":2100,"country":"Denmark"},{"id":"eva","name":"Department of Archaeogenetics, Max Planck Institute for Evolutionary Anthropology","address":"Deutsche Pl. 6","city":"Leipzig","state":"Saxony","postal-code":2115,"country":"Germany"},{"id":"hki","name":"Department of Paleobiotechnology, Leibniz Institute for Natural Product Research and Infection Biology Hans Knöll Institute","address":"Adolf-Reichwein-Straße","city":"Jena","state":"Thuringen","postal-code":4069,"country":"Germany"},{"id":"ksu","name":"Veterinary Diagnostic Laboratory, Kansas State University College of Veterinary Medicine","address":"1800 Denison Ave","city":"Manhattan","state":"KS","postal-code":66506,"country":"United States"},{"id":"xx"}],"bibliography":["refs.bib"],"license":"CC BY","crossref":{"lst-prefix":"Code Block"}},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":true,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","highlight-style":"github","include-in-header":{"text":"\\usepackage{lineno}\\linenumbers\n\\usepackage[noblocks]{authblk}\n\\renewcommand*{\\Authsep}{, }\n\\renewcommand*{\\Authand}{, }\n\\renewcommand*{\\Authands}{, }\n\\renewcommand\\Affilfont{\\small}\n"},"number-sections":true,"output-file":"taxprofiler-manuscript.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"documentclass":"article","colorlinks":true,"fontfamily":"libertinus","template-partials":["title.tex"],"title":"nf-core/taxprofiler: highly parallelised and flexible pipeline for metagenomic taxonomic classification and profiling","author":[{"name":"Sofia Stamouli","given":"Sofia","family":"Stamouli","orcid":"0009-0006-0893-3771","roles":["conceptualization","software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"Moritz E. Beber","given":"Moritz","family":"Beber","orcid":"0000-0003-2406-1978","roles":["conceptualization","software","editing"],"affiliations":[{"ref":"usb"}]},{"name":"Tanja Normark","given":"Tanja","family":"Normark","orcid":null,"roles":["software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"Thomas A. Christensen II","given":"Thomas A.","family":"Christensen II","orcid":"0000-0003-1219-9320","roles":["software","editing"],"affiliations":[{"ref":"ksu"}]},{"name":"Lili Andersson-Li","given":"Lili","family":"Andersson-Li","orcid":"0000-0002-6059-4192","roles":["software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"Maxime Borry","given":"Maxime","family":"Borry","orcid":"0000-0001-9140-7559","roles":["software","editing"],"affiliations":[{"ref":"eva"}]},{"name":"Mahwash Jamy","given":"Mahwash","family":"Jamy","orcid":null,"roles":["software","editing"],"affiliations":[{"ref":"ki"},{"ref":"kuh"}]},{"name":"nf-core community","url":"https://nf-co.re","email":"core@nf-co.re","roles":["software"],"affiliations":[{"ref":"xx"}]},{"name":"James A. Fellows Yates","given":"James A.","family":"Fellows Yates","orcid":"0000-0001-5585-6277","email":"james_fellows_yates@eva.mpg.de","corresponding":true,"roles":["conceptualization","project administration","software","supervision","writing","editing"],"affiliations":[{"ref":"eva"},{"ref":"hki"}]}],"affiliations":[{"id":"ki","name":"Department of Microbiology, Tumor and Cell Biology, Karolinkska Institutet","address":"Solnavägen 1","city":"Solna","state":"Stockholm","postal-code":17177,"country":"Sweden"},{"id":"kuh","name":"Department of Clinical Microbiology, Karolinska University Hospital","address":"Anna Steckséns gata 41","city":"Solna","state":"Stockholm","postal-code":17177,"country":"Sweden"},{"id":"usb","name":"Unseen Bio ApS","address":"Fruebjergvej 3","city":"Copenhagen","state":"Capital Region","postal-code":2100,"country":"Denmark"},{"id":"eva","name":"Department of Archaeogenetics, Max Planck Institute for Evolutionary Anthropology","address":"Deutsche Pl. 6","city":"Leipzig","state":"Saxony","postal-code":2115,"country":"Germany"},{"id":"hki","name":"Department of Paleobiotechnology, Leibniz Institute for Natural Product Research and Infection Biology Hans Knöll Institute","address":"Adolf-Reichwein-Straße","city":"Jena","state":"Thuringen","postal-code":4069,"country":"Germany"},{"id":"ksu","name":"Veterinary Diagnostic Laboratory, Kansas State University College of Veterinary Medicine","address":"1800 Denison Ave","city":"Manhattan","state":"KS","postal-code":66506,"country":"United States"},{"id":"xx"}],"bibliography":["refs.bib"],"license":"CC BY","crossref":{"lst-prefix":"Code Block"}},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}